#!/usr/bin/env node
import "source-map-support/register";
import * as cdk from "aws-cdk-lib";
import { LambdaDelayStack } from "../lib/lambda_delay";
import { GuardDutyS3Stack } from "../lib/guard_duty_s3_stack";
import * as environ from "../params";
const app = new cdk.App();

// Instantiate the LambdaDelayStack
const lambdaDelayStack = new LambdaDelayStack(app, "LambdaDelayStack", {
  delayTime: environ.Params.delayTime, // Specify the delay time in seconds
  //env: { account: "your-account-id", region: "your-region" },
});

// Instantiate the main GuardDutyS3Stack, passing the delay provider token
const GuardDutyStack = new GuardDutyS3Stack(app, "GuardDutyS3Stack", {
  delayProvider: lambdaDelayStack.delayProvider,
  //env: { account: "your-account-id", region: "your-region" },
});

GuardDutyStack.node.addDependency(lambdaDelayStack);
